{{- if and (env.Getenv "BREW_RC_RELEASE_VERSION" "") (env.Getenv "BREW_Y1_RELEASE_VERSION" "") -}}
{{- /*

  We wrap this template in a test so that the body of the output is
  empty when there is no "current" version release. The output file
  must end up completely empty, so we need to remove whitespace from
  around the first and last template instructions.

*/ -}}

name = "rhel-9.6-microshift-brew-optionals-4.{{ .Env.MINOR_VERSION}}-rc-fips"
description = "FIPS-enabled version of rhel-9.6-microshift-brew-optionals-4.{{ .Env.MINOR_VERSION}}-rc"
version = "0.0.1"
modules = []
groups = []
distro = "rhel-96"

# Use the base brewery blueprint as parent
parent = "rhel-9.6-microshift-brew-optionals-4.{{ .Env.MINOR_VERSION}}-rc"

# Add only FIPS-specific configuration
[[packages]]
name = "crypto-policies-scripts"
version = "*"

[customizations.kernel]
append = "fips=1"

[[customizations.files]]
path = "/etc/crypto-policies/config"
data = "FIPS"
{{- end -}}
